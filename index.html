<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Scazlab2016 by georgewildridge</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Scazlab2016</h1>
      <h2 class="project-tagline">A repo for the code I write in preparation for and while working at Yale&#39;s Social Robotics Lab for 2016</h2>
      <a href="https://github.com/georgewildridge/ScazLab2016" class="btn">View on GitHub</a>
      <a href="https://github.com/georgewildridge/ScazLab2016/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/georgewildridge/ScazLab2016/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <p>I am using this page as a resource to document my work leading up to, in and preceding my third summer in the <a href="http://scazlab.yale.edu/">Social Robotics Lab</a>. The finalized version of this document should be completed by the end of November 2016 with five deliverables: a review paper that demonstrates my work leading up to the lab, a daily blog detailing my work while in the lab and a final paper, presentation and poster that wrap up my work and my results.</p>

<p>A brief disclaimer that this blog currently serves as a resource for myself more than anything else, as such, I have pointers to code that has not been posted as the code is currently part of active research. </p>

<h1>
<a id="preparation" class="anchor" href="#preparation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Preparation</h1>

<p>The main aspect of this section will be the review paper I wrote in preparation for the lab. I will also outline some of the work I did leading up to this paper including the papers I read and the lectures I watched. I hope to get all of this up in the near future. (todays date: 6/14/16) </p>

<h1>
<a id="working-in-scaz-lab" class="anchor" href="#working-in-scaz-lab" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Working in Scaz Lab</h1>

<h3>
<a id="61316" class="anchor" href="#61316" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/13/16</h3>

<p>The first project I am doing with Alessandro and Olivier is using deep learning to recognize letters and digits off <a href="http://www.snapcircuits.net/">snap circuits</a>. I believe this is part of a broader effort within social hierarchical learning but I will confirm later. 
In order to use deep learning I first must build a dataset to train on. That is what I am currently working towards and hope to be doing Wednesday. Until then I am preparing to run Olivier's code in an Ubuntu virtual machine. A lot of today was spent downloading and installing the necessary programs. However, after I finished I had run out of space in my virtual machine, a problem that is taking a lot longer than I expected to solve.  Tomorrow I plan to run Olivier's code which segments the image between the pegs. I spent a couple of hours looking through it today and figuring out which code does what and what dependencies his code has.<br>
In the future I hope to take the segmented images and train a neural net on them using the <a href="https://www.tensorflow.org/">Tensorflow</a> library.</p>

<h3>
<a id="61416" class="anchor" href="#61416" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/14/16</h3>

<p>After a few hours trying to figure out how to expand the virtual machine I ended up making a mistake which caused a blank black screen after opening. Frustrated, I decided to start over and created a far larger virtual machine that should be very difficult to fill. After re-downloading all the programs and setting things up again I ran into this issue with opencv when I tried to run the code:</p>

<pre><code>cv2.error: -------src-dir-------/opencv-2.4.10/modules/highgui/src/window.cpp:501: error: (-2) The function is not implemented. Rebuild the library with Windows, GTK+ 2.x or Carbon support. If you are on Ubuntu or Debian, install libgtk2.0-dev and pkg-config, then re-run cmake or configure script in function cvShowImage
</code></pre>

<p>Unfortunately I downloaded opencv using standard the built in library within ubuntu so I could not find a way to make the change it called for without compiling from source. So following the advice on <a href="http://ubuntuforums.org/showthread.php?t=1916062">this page</a> I began following <a href="http://www.samontab.com/web/2014/06/installing-opencv-2-4-9-in-ubuntu-14-04-lts/">this tutorial</a> which did not fully compile on my first pass through the tutorial. At 6:30 I called it quits and I plan on picking it back up tomorrow.</p>

<h3>
<a id="61516" class="anchor" href="#61516" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/15/16</h3>

<p>On my way to work today I ate it on my skateboard and hurt my wrist pretty bad. Although I thought I would be fine, upon arriving at the lab there was a huge lump below my thumb and I was having a lot of difficulty moving my hand and my fingers. Worried I broke my wrist I decided to go get xrays and see a doctor. Luckily, I came away without a break and  just a bad sprain. I'll know more next Wednesday about the severity of the injury. As a result of all of this (and the network being down at my house) I was unable to get work done today.</p>

<h3>
<a id="61616" class="anchor" href="#61616" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/16/16</h3>

<p>Picking up where I left off Tuesday, I continued with the tutorial. After getting through only about 20% of the install I decided that my issue must have been in my installation of cmake. So I reinstalled cmake from source before lunch following <a href="http://askubuntu.com/questions/610291/how-to-install-cmake-3-2-on-ubuntu-14-04">this tutorial</a>. It worked until I ran into another error around 76% which I was able to circumvent using <a href="https://gist.github.com/melvincabatuan/8dc300531e84822d368c">this tutorial</a>. Finally, I was able to install opencv; however, 2when I ran Olivier's code I again received the same error. Currently I am unsure how to continue and I figure I will just try to run this code on another machine.</p>

<p>Alessandro also took some time to show me how to use <a href="http://www.rethinkrobotics.com/baxter/">Baxter</a>  today. Here are some important commands that I need to remember:</p>

<pre><code>3989  cd ros_devel_ws/
3990  catkin_make
3991  rospack profile
3992  source devel/setup.bash 
3993  rospack profile
3994  ls src/
3995  roslaunch snap_circuits board_calibrator.launch 
3996  history
</code></pre>

<p>Importantly I am using a different set of code then I was using before called boardcalibrator. This code defines the edges of the board and manipulates the image of the board the computer sees independent of the camera angle. <strong>Picture of before and after as well as a general picture of the setup of experiment</strong>.  My goal for tomorrow is to be able to run the code with the camera. </p>

<h3>
<a id="61716" class="anchor" href="#61716" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/17/16</h3>

<p>I made progress today but was not able to run the code with the camera and I will have to get around to it Monday. Today revolved around installing and learning to work with <a href="http://wiki.ros.org/indigo">ROS Indigo</a>. This entails going through the tutorials. My goal is to figure out how to run the command</p>

<pre><code>roslaunch snap_circuits board_calibrator.launch
</code></pre>

<p>Running it require a good amount of file configuration so that is what I have spent my day doing. My prospective schedule is as follows: by the end of Monday I hope to have begun building the dataset through taking pictures of each piece, I will most likely devote all of Tuesday to taking these pictures, the beginning of Wednesday will be applying Olivier's code to the photos I took, the end of Wednesday will be devoted to learning to work with TensorFlow and ensuring the ability to apply it to the small dataset Olivier has already built. It is highly probable that my work with TensorFlow will spill into Thursday but hopefully I can get through it Wednesday. Optimistically, however, I would then go on to classifying all the photos I took Tuesday on Thursday and the first half of Friday before training a neural net on the data Friday. Monday would then be devoted to merging it with Olivier's code and ensuring its function on Baxter along with beginning a formal write-up of the project to ensure I understand the motivations of the project as a whole. Pessimistically, this whole process takes until Tuesday or even Wednesday. I hope this is not the case however. </p>

<h3>
<a id="62016" class="anchor" href="#62016" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/20/16</h3>

<p>I struggled again to run the code today.  Predominantly my day was spent just trying more tutorials and installing ROS dependencies for the code after running into errors. Below are the pieces I am trying to classify on a 7x10 grid of pegs. </p>

<h3>
<a id="62116" class="anchor" href="#62116" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/21/16</h3>

<p>I finally figured out how to run roslaunch today on own computer. However, I then quickly had an issue with the camera I was trying to use and spent a while trying to locate a new one. Then, much to my disappointment, instead of running smoothly I got the error</p>

<pre><code>[usb_cam-1] process has died [pid 12797, exit code -11, cmd /opt/ros/indigo/lib/usb_cam/usb_cam_node __name:=usb_cam __log:=/home/george/.ros/log/1954eca6-37f3-11e6-a0d7-000c29f19534/usb_cam-1.log].
log file: /home/george/.ros/log/1954eca6-37f3-11e6-a0d7-000c29f19534/usb_cam-1*.log
</code></pre>

<p>After a few hours of attempting solutions to problems that vaguely resembled mine in the forums I didn't understand what was wrong. In the office there is a computer that is used with Baxter that another intern is using, but all the code is on the computer and currently runs fine. Given this, I figured I must have had some newer version of the code that I downloaded off GitHub that hasn't been tested for errors yet. I sent myself all the files on the other computer hoping it would solve the problem; however, this was to no avail. I got the same error. Quite frustrating. Tomorrow I will either figure out how to run the code on my computer or resort to splitting time using the lab computer. </p>

<h3>
<a id="62216" class="anchor" href="#62216" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/22/16</h3>

<p>Still couldn't get passed this. I looked through the log file to no avail and have been scratching my head on how to continue. I spent about 4 hrs but I also went to the Doctor who informed me that my fall the other day caused a hairline fracture in my arm. Before leaving, Olivier suggested that my openCV version might be the issue so I began the process of uninstalling 2.4.13 and installing the default 2.4.8 that comes with Ubuntu 14.04.</p>

<h3>
<a id="62316" class="anchor" href="#62316" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/23/16</h3>

<p>I started the day installing OpenCV 2.4.8 and then reinstalling ROS and CMAKE to get the code to run. Nevertheless I got the same error which convinced me that I had to use OpenCV 3. Fortunately, Alessandro got back today and interrupted me as I was trying to install the new version of OpenCV and he was able to get the code running with 2.4.8 in about 10 minutes. It turns out my computer did not like the resolution of the camera I was using and scaling it back to 480p from 720p solved my problem. I was then able to begin working on building the dataset and was able to completely photograph 2 pieces and begin a third. <strong>The dataset can be found here</strong> </p>

<h3>
<a id="62416" class="anchor" href="#62416" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/24/16</h3>

<p>I continued building the dataset today, getting through the numbers and a pass at the length three pieces. Further, I began reading the documentation of Tensorflow. I would like to ensure that I can get Tensorflow working on Olivier's small dataset before I spend a day or two classifying the data I have collected. I don't want to have to reformat after if Tensorflow has any data specific requirements. </p>

<h3>
<a id="62716" class="anchor" href="#62716" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/27/16</h3>

<p>Today I continued recording data, getting through the miscellaneous three length pieces and beginning the miscellaneous odd shaped pieces. I hope to learn more about Tensorflow tomorrow, going through a tutorial or two, before attempting to apply it to Olivier's data. By Wednesday I should be devoting my time to . </p>

<h3>
<a id="62816" class="anchor" href="#62816" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/28/16</h3>

<p>Today I pretty much finished off taking pictures for the dataset. Odds are I have to go take more photos for some of the blocks; however, I will leave that for another day. Further I began the <a href="https://www.tensorflow.org/versions/r0.9/tutorials/mnist/beginners/index.html">MNIST For ML Beginners</a> and hope to finish this tutorial and the <a href="https://www.tensorflow.org/versions/r0.9/tutorials/mnist/pros/index.html">Deep MNIST for Experts</a> tomorrow. I also hope to apply Olivier's code to some data I have collected now. By the end of tommorrow it would be great to have a neural net prepared to take the data I have collected and train upon it. This would allow me to focus on classifying the dataset Thursday and Friday and leave me finding just finding time to run it. </p>

<h3>
<a id="62916" class="anchor" href="#62916" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/29/16</h3>

<p>I spent most of today understanding Tensorflow through doing both the tutorials I highlighted yesterday and going through the documentation. The main question I had on my mind was how should I classify the dataset for use within Tensorflow. Further I also did some interesting <a href="http://colah.github.io/posts/2015-09-Visual-Information/">light reading</a> on a cost function called "cross-entropy" that I had not come into much contact with. The most significant aspect of my day was a discussion I had with Olivier about the project and his code. It turns out I was reading part of the wrong code, and that he already has a great format for me to begin classifying the data. Further, he has already implemented a classifier and a quick and desigined a way to pull from the data format. So walking away from this meaning I was theoretically able to sit down and get to work on classifieing the data. </p>

<h3>
<a id="63016" class="anchor" href="#63016" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6/30/16</h3>

<p>Although I was theoretically capable of beginning work on the classifier I ran into the same issue that I did a few weeks ago trying to execute the code. </p>

<pre><code>cv2.error: -------src-dir-------/opencv-2.4.10/modules/highgui/src/window.cpp:501: error: (-2) The function is not implemented. Rebuild the library with Windows, GTK+ 2.x or Carbon support. If you are on Ubuntu or Debian, install libgtk2.0-dev and pkg-config, then re-run cmake or configure script in function cvShowImage
</code></pre>

<p>So I spent my day going through tutorials trying to resolve the issue before discovering, with Alessandro's and Olivier's help, that the source of all my woes has been my installation of anaconda. After removing it I began reconfiguring parts of my environment to run again. At the end of the day I was still running into problems getting the code to run but I think with another hour it will be good to go. </p>

<h3>
<a id="7116" class="anchor" href="#7116" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7/1/16</h3>

<p>By lunchtime today I had Olivier's code up and running on my machine and I was ready to begin work on classifying the data. To do this I removed cmake and reinstalled it, then reinstalled ros, then created a new catkin_ws directory and then installed some dependencies that were specific to Olivier's code… but it finally all works fluidly. </p>

<p>After lunch I played around with Olivier's code a little bit, trying to figure out what exactly I needed to do before I jumped into classifying the some 300 pictures I have. One of my main sources of annoyance was the fact that all the pictures would eventually have to be in one file which was a problem because the way I obtained the files saved them in a way that many of my pictures shared file names. Further all the pictures needed to be converted from jpg to png. To mitigate all of this I wrote a short piece of code:</p>

<pre><code>for i in range(10): 
    if i &lt; 10:
        im = Image.open('Four/7/frame000' + str(i) + '.jpg') 
    else:
        im = Image.open('Four/7/frame00' + str(i) + '.jpg') 
    im.save('Four/boards/board_' + str(146 + i) + '.png') 
    open('Four/boards/board_' + str(146 + i) + '.json','w')
</code></pre>

<p>The remainder of my day was spent reformatting the pictures. </p>

<h3>
<a id="71116-through-72216" class="anchor" href="#71116-through-72216" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7/11/16 through 7/22/16</h3>

<p>I spent this week classifying all the images I took. It was an arduous process but it means I get to move onto more fun things with the data I collected. </p>

<h3>
<a id="71816" class="anchor" href="#71816" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7/18/16</h3>

<p>Today I spent my time attempting to train a classifier on the data I collected. I ran into errors twice 3 hrs into training unfortunately, so I am going to have to wait for tomorrow to get any concrete results. In the meantime I have been exploring tensorflow more and looking for ways that the classifier could potentially be improved. I spoke to Olivier about  what he thinks is the best way to move forward and at the moment I am tasked to just research, and take detailed notes both recording results and using GitHub to document code, the best ways to preprocess the data and the possibility of changing the algorithm. The first place I am going to look for this is what method those classifying the MNIST dataset used to achieve their highly successful result. I am also keeping it in the back of my mind that there is a very real likelihood I will have to add more data to the dataset and to more data classification to achieve a robust classifier. </p>

<h3>
<a id="7192016" class="anchor" href="#7192016" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7/19/2016</h3>

<p>Today I spent my time attempting to understand the result that was given back to me when I ran the code upon my dataset. I also researched the best way for me to go about improving the accuracy of the classifier and how to make the most of the small dataset that I have collected. Currently an SVM classifier is being used; (link papers I read by looking through search history).  Further, I brushed up on Tensorflow. </p>

<h3>
<a id="7202016" class="anchor" href="#7202016" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7/20/2016</h3>

<p>I began trying to implement some changes to the classifier including the addition of a better way to guage just how well the classifier is working. The hard part I have found is inputting  the data into tensorflow. A problem I am currently still working. So my day was spent trying to get the code to mesh. I am excited to begin trying out various classifiers when I get through this issue. </p>

<h3>
<a id="72116-through-72716" class="anchor" href="#72116-through-72716" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7/21/16 through 7/27/16</h3>

<p>Getting the data to mesh with tensorflow was considerably more challenging then was expected and required me to get very familiar with both Olivies code and the tensorflow library; however, I believe I finally got the code to go through today. Initially I believed that if I was able to convert the data into a tensorflow object type called a tenosr I would easily be able to pass it through the dataset. So I spent Thursday and Friday of last week trying to get the data to pass as a tensor. This meant reformatting parts of the dataset to enable conversion. I kept getting an issue that went something like "Can't convert None type to tensor". This was referring specifically to the way Olivie labeled unlabeled squares as 'None'. So instead of None I swapped in -1 as the go to label for unalabeled squares and was able to get it to work. After successfully converting the data into tensor objects I found out that tensor variables could not be passed to the tensorflow classifier I was attempting to use. In this instance I was using just the softmax classifier that the <a href="https://www.tensorflow.org/versions/r0.10/tutorials/mnist/pros/index.html">advanced tutorial</a> initially uses. It is worth noting that upon seeing how the tutorial took batches from the MNIST dataset I attempted to take batches from my dataset with <a href="">Tensorflow's shufflebatch</a> function. </p>

<p>Going into Monday I intended to get the data through the classifier; however,  I couldn't seem to get the raw data through the network and getting the tensors through wasn't working either. Olivier also gave me an exceedingly helpful tip: limit the size of the dataset I that I am testing with. An idea that ended up saving me a lot of time as I was attempting to fix the code with my full dataset which meant waiting four to five minutes after each change to see the changes effect. By the end of Monday I was not sure why it wasn't working and just ended up being frustrated as I thought I had tried everything and was struggling for new ideas on how to fix the code. Lost, Tuesday was spent reading through the Tensorflow documentation and searching for something I might have missed and just trying many different ways to get the code through. At that moment it was neither passing as an numpy array or as a tensor. By the end of Tuesday I believed that I was going to have to resort to following <a href="">this article</a> and reformat the dataset in a way I knew Tensorflow would take. I began the initial steps to do this on Wednesday; however, I had the idea to try to convert the tensor back to a np array and pass it and it might have worked. At the moment the code hasn't failed; however, it is taking an exeedingly long time to run. I assume something is wrong; however, I will leave it up overnight to be sure. </p>

<p>7/28/16
Despite yesterday's code not working as the command I wrote to convert the tensor back into an np array just made the code become perpetually unresponsive, I finally got the data through today. The big breakthrough I had was when I decided to get rid of the shufflebatch function and I got the error that the data could not be converted to a float to fit into the variable. Armed with this knowledge I realized that the reason I couldn't get the data through was because of the datas original formatting with the actual labels e.g. D6. What I did was write a small script which converted each label into a designated number e.g. D6 to 8. Which gave me the ability to cast it as an int. Further, I made the mistake of submitting the labels as label, orientation pairs instead of as an array of classes. Once I sorted this out I was able to get the softmax classifier (basically a one layer neural net) to work.  My results:</p>

<p>7/29/16
My next task was to figure out how to get it to run in a convolutional neural network. </p>

<p>8/1/16</p>

<p>8/2/16
At the moment I do not feel I understand the problem enough to implement a multiclass classifier so, for the moment, I have just treated each unique pair as a class. I realize this is not the best approach as I feel in doing this I inhibit the network from making connections; however, at the same time I don't know if I am knowledgeable enough to even make that call. Tonight I hope to brush up on a lot of my deep learning material to make sure I know what I am doing. In the mean time I have a lingering feeling that the actually labeled values are too diluted within the network for my results to reach the improvement I am hoping for. I think that if I implemented two classifiers, one to say that there is or there is not a labeled value in an image and a second to actually do the labelling. Olivier briefly mentioned this but pushed it aside so I am going to run it by Alessandro beforehand. However, I still need to confirm my suspicion in the data so I am first going to get better numbers from the classifier before pushing forward. </p>

<h1>
<a id="my-research-and-results" class="anchor" href="#my-research-and-results" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>My Research and Results</h1>

<h1>
<a id="conclusion" class="anchor" href="#conclusion" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conclusion</h1>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/georgewildridge/ScazLab2016">Scazlab2016</a> is maintained by <a href="https://github.com/georgewildridge">georgewildridge</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
